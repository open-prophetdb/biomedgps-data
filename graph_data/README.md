## Download the Formatted Data

The formatted data is available at [Google Driver](https://drive.google.com/drive/folders/1DekWFRbGCmGpLHDIZsJCsWvqBYzZ-EoI?usp=sharing)

Now you can download the formatted data and put all data you expected in the `graph_data` folder. Other codes will read the data from this folder.

## ID Format

### Entity ID

We use `entity_id` to represent an entity. It is a string of the following format:

```
<entity_type>:<database_id>
```

such as `Gene::ENTREZ:1234`, `Disease::OMIM:1234`, `Drug::DRUGBANK:DB1234`.

### Relation ID

We use `relation_id` to represent a relation. It is a string of the following format:

```
<resource>::<relation_type>::<source_entity_type>:<target_entity_type>
```

such as `STRING::INTERACTS_WITH::Gene:Gene`, `STRING::INTERACTS_WITH::Gene:Disease`.

## Data Format

### Entity File

The entity file is a tab-separated file with the following format:

```
id	name	label	resource	description	synonyms	pmids	taxid	xrefs
SYMP:0000149	obsolete sudden onset of severe chills	Symptom	SymptomOntology					
SYMP:0000259	dry hacking cough	Symptom	SymptomOntology	A dry cough that is characterized by a rough and loud sound.				
```

### Relation File

The relation file is a tab-separated file with the following format:

```
raw_source_id   raw_target_id   raw_source_type raw_target_type relation_type   resource        pmids   key_sentence    source_id       source_type     target_id   target_type
ENTREZ:2261     CHEMBL:CHEMBL100473     Gene    Compound        DGIDB::OTHER::Gene:Compound     DGIDB                   ENTREZ:2261     Gene    MESH:C113580Compound
ENTREZ:2776     CHEMBL:CHEMBL100473     Gene    Compound        DGIDB::OTHER::Gene:Compound     DGIDB                   ENTREZ:2776     Gene    MESH:C113580Compound
```

### Train/Valid/Test File

The train/valid/test file is a tab-separated file with the following format, we call it triplet file, each file contains a list of triplets which are represented by [head_entity_id, relation_id, tail_entity_id]. The format of each head_entity_id and tail_entity_id is composed of entity_type and database_id, such as `Gene::ENTREZ:1234`, `Disease::MONDO:1234`, `Compound::DRUGBANK:DB1234`.

```
Gene::ENTREZ:3358       DGIDB::OTHER::Gene:Compound     Compound::MESH:D008784
Gene::ENTREZ:347688     DGIDB::INHIBITOR::Gene:Compound Compound::DrugBank:DB01394
Gene::ENTREZ:5914       DGIDB::OTHER::Gene:Compound     Compound::DrugBank:DB01394
```


### Model File

The trained embeddings are generated by dglke_train or dglke_dist_train CMD. The trained embeddings are stored in npy format. Usually there are two files:

Entity embeddings Entity embeddings are stored in a file named in format of dataset_name>_<model>_entity.npy and can be loaded through numpy.load().
Relation embeddings Relation embeddings are stored in a file named in format of dataset_name>_<model>_relation.npy and can be loaded through numpy.load().


## Directory Structure

You may need to create the following directory structure to store the data and the trained embeddings. Some files are generated by the dgl-ke package and others are created by yourself (such as the raw_relations.tsv, raw_relations_hrt.tsv, train.tsv, valid.tsv and test.tsv files). Please note the dataset_name and model_name should be replaced by your own dataset name and model name. You need to keep them same with the dataset name and model name you use in the `../wandb/wandb_sweep_kge.yaml` file.

```
biomedgps-data
  |-- README.md
  |-- <dataset_name>
  |    |-- entities.tsv           # Generated by the dgl-ke package, ID mapping of entities
  |    |-- relations.tsv          # Generated by the dgl-ke package, ID mapping of relations
  |    |-- test.tsv               # Training set, each line contains a triplet [h, r, t]
  |    |-- valid.tsv              # Validation set, each line contains a triplet [h, r, t]
  |    |-- train.tsv              # Test set, each line contains a triplet [h, r, t]
  |    |-- raw_relations.tsv      # Format is mentioned above
  |    |-- raw_relations_hrt.tsv  # Each file contains a list of triplets which are represented by [head_entity_id, relation_id, tail_entity_id]
  |-- models
  |    |-- <model_name>
  |    |    |-- config.json
  |    |    |-- <dataset_name>_<model>_entity.npy
  |    |    |-- <dataset_name>_<model>_relation.npy
```
